diff --git a/src/utils.lua b/src/utils.lua
index e58bd706ba4eaa6e7a2a149620fb8d2d3a7049e0..55feff095271fcafd5e9a519eddef4d9931eb85a 100644
--- a/src/utils.lua
+++ b/src/utils.lua
@@ -124,6 +124,12 @@ local function typeEquality(a: any, b: any): boolean | nil
 		return false
 	end
 
+	-- Skip non-tables: metatables on primitives (e.g. strings return
+	-- "The metatable is locked") are not meaningful for type equality.
+	if typeof(a) ~= "table" then
+		return nil
+	end
+
 	if not getmetatable(a) and not getmetatable(b) then
 		return nil
 	end
